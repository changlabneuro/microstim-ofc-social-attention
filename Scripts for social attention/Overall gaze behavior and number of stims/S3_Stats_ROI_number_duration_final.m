%% Compare behavior across Eyes, Non-eye Face, and Dots

% Upload Gaze_ROI_Summary_Combined.mat and Dot_ROI_Summary_Combined.mat in
% two_ROI folder (Gaze_summary and Dot_summary variables)

%% Variables and day information 

% All days
OFC_day.All={'07202019'  '07312019'  '08052019'  '08122019'  '08292019' ...
    '09052019'  '09192019'  '10012019'  '11052019'   '12122019' ...  
    '12182019'  '01032020'  '01102020'  '01242020'  '02022020'...
    '11082021'  '12222021'  '01032022'  '01212022'  '01282022'...
    '02032022'  '02092022'  '02152022'  '02192022'  '02242022'...
    '02282022'  '03172022'}; 

ACCg_day.All={'07222019'  '08022019'  '08072019'  '08232019'  '09172019' ...
    '09242019'  '09282019'  '10102019'  '12092019'  '12132019' ...
    '01072020'  '01172020'  '01272020'  '01312020'  '02072020'...
    '11042021'  '12292021'  '01202022'  '01312022'  '02212022'...
    '03242022'  '04192022'  '04262022'  '05172022'  '05242022'...
    '05272022'  '05302022'};  

dmPFC_day.All={'07182019','07262019'  '08092019'  '08142019'  '08212019' ...
    '09032019'  '09222019'  '10042019'  '12052019'  '12102019' ...
    '12162019'  '01022020'  '01132020'  '01222020'  '02062020'...
    '11052021'  '12172021'  '01242022'  '02122022'  '03052022'...
    '03182022'  '04012022'  '05032022'  '05122022'  '05142022'...
    '05192022'  '05262022'};  

% Lynch days
OFC_day.Lynch={'07202019'  '07312019'  '08052019'  '08122019'  '08292019' ...
    '09052019'  '09192019'  '10012019'  '11052019'   '12122019' ...  
    '12182019'  '01032020'  '01102020'  '01242020'  '02022020'};  
ACCg_day.Lynch={'07222019'  '08022019'  '08072019'  '08232019'  '09172019' ...
    '09242019'  '09282019'  '10102019'  '12092019'  '12132019' ...
    '01072020'  '01172020'  '01272020'  '01312020'  '02072020'};  
dmPFC_day.Lynch={'07182019','07262019'  '08092019'  '08142019'  '08212019' ...
    '09032019'  '09222019'  '10042019'  '12052019'  '12102019' ...
    '12162019'  '01022020'  '01132020'  '01222020'  '02062020'};            

% Tarantino days
OFC_day.Tarantino={'11082021'  '12222021'  '01032022'  '01212022'  '01282022'...
    '02032022'  '02092022'  '02152022'  '02192022'  '02242022'...
    '02282022'  '03172022'}; 
ACCg_day.Tarantino={'11042021'  '12292021'  '01202022'  '01312022'  '02212022'...
    '03242022'  '04192022'  '04262022'  '05172022'  '05242022'...
    '05272022'  '05302022'};  
dmPFC_day.Tarantino={'11052021'  '12172021'  '01242022'  '02122022'  '03052022'...
    '03182022'  '04012022'  '05032022'  '05122022'  '05142022'...
    '05192022'  '05262022'};  

% All

All_day.All={'07202019'  '07312019'  '08052019'  '08122019'  '08292019' ...
    '09052019'  '09192019'  '10012019'  '11052019'   '12122019' ...  
    '12182019'  '01032020'  '01102020'  '01242020'  '02022020'...
    '11082021'  '12222021'  '01032022'  '01212022'  '01282022'...
    '02032022'  '02092022'  '02152022'  '02192022'  '02242022'...
    '02282022'  '03172022' ...
    '07222019'  '08022019'  '08072019'  '08232019'  '09172019' ...
    '09242019'  '09282019'  '10102019'  '12092019'  '12132019' ...
    '01072020'  '01172020'  '01272020'  '01312020'  '02072020'...
    '11042021'  '12292021'  '01202022'  '01312022'  '02212022'...
    '03242022'  '04192022'  '04262022'  '05172022'  '05242022'...
    '05272022'  '05302022'...
    '07182019','07262019'  '08092019'  '08142019'  '08212019' ...
    '09032019'  '09222019'  '10042019'  '12052019'  '12102019' ...
    '12162019'  '01022020'  '01132020'  '01222020'  '02062020'...
    '11052021'  '12172021'  '01242022'  '02122022'  '03052022'...
    '03182022'  '04012022'  '05032022'  '05122022'  '05142022'...
    '05192022'  '05262022'};  

All_day.Lynch={'07202019'  '07312019'  '08052019'  '08122019'  '08292019' ...
    '09052019'  '09192019'  '10012019'  '11052019'   '12122019' ...  
    '12182019'  '01032020'  '01102020'  '01242020'  '02022020'...
    '07222019'  '08022019'  '08072019'  '08232019'  '09172019' ...
    '09242019'  '09282019'  '10102019'  '12092019'  '12132019' ...
    '01072020'  '01172020'  '01272020'  '01312020'  '02072020'...
    '07182019','07262019'  '08092019'  '08142019'  '08212019' ...
    '09032019'  '09222019'  '10042019'  '12052019'  '12102019' ...
    '12162019'  '01022020'  '01132020'  '01222020'  '02062020'}; 

All_day.Tarantino={'11082021'  '12222021'  '01032022'  '01212022'  '01282022'...
    '02032022'  '02092022'  '02152022'  '02192022'  '02242022'...
    '02282022'  '03172022'...
    '11042021'  '12292021'  '01202022'  '01312022'  '02212022'...
    '03242022'  '04192022'  '04262022'  '05172022'  '05242022'...
    '05272022'  '05302022'...
    '11052021'  '12172021'  '01242022'  '02122022'  '03052022'...
    '03182022'  '04012022'  '05032022'  '05122022'  '05142022'...
    '05192022'  '05262022'};

%% Compare across ROIs (all day)

monkey_names={'All', 'Lynch', 'Tarantino'};
    
for nmonkey=1:3
    monkey_id=char(monkey_names(nmonkey));

    [Stats.All_day.(monkey_id).total_number.eye_neface_p,Stats.All_day.(monkey_id).total_number.eye_neface_h]=signrank(Gaze_summary.All_day.(monkey_id).m1_eye.total_number,Gaze_summary.All_day.(monkey_id).m1_neface.total_number);
    [Stats.All_day.(monkey_id).total_number.eye_dot_p,Stats.All_day.(monkey_id).total_number.eye_dot_h]=signrank(Gaze_summary.All_day.(monkey_id).m1_eye.total_number,Dot_summary.All_day.(monkey_id).m1_eye.total_number);
    
    [Stats.All_day.(monkey_id).average_duration.eye_neface_p,Stats.All_day.(monkey_id).average_duration.eye_neface_h]=signrank(Gaze_summary.All_day.(monkey_id).m1_eye.average_duration,Gaze_summary.All_day.(monkey_id).m1_neface.average_duration);
    [Stats.All_day.(monkey_id).average_duration.eye_dot_p,Stats.All_day.(monkey_id).average_duration.eye_dot_h]=signrank(Gaze_summary.All_day.(monkey_id).m1_eye.average_duration,Dot_summary.All_day.(monkey_id).m1_eye.average_duration);
    
end

%% Compare across ROIs (for each region separately)

monkey_names={'All', 'Lynch', 'Tarantino'};
region_names={'OFC', 'dmPFC', 'ACCg'};
    
for nmonkey=1:3
    monkey_id=char(monkey_names(nmonkey));

    for nregion=1:3
        region_id=char(region_names(nregion));

        % Sign rank is paired (median)

        [Stats.(region_id).(monkey_id).total_number.eye_neface_p,Stats.(region_id).(monkey_id).total_number.eye_neface_h]=signrank(Gaze_summary.(region_id).(monkey_id).m1_eye.total_number,Gaze_summary.(region_id).(monkey_id).m1_neface.total_number);
        [Stats.(region_id).(monkey_id).total_number.eye_dot_p,Stats.(region_id).(monkey_id).total_number.eye_dot_h]=signrank(Gaze_summary.(region_id).(monkey_id).m1_eye.total_number,Dot_summary.(region_id).(monkey_id).m1_eye.total_number);
     
        [Stats.(region_id).(monkey_id).average_duration.eye_neface_p,Stats.(region_id).(monkey_id).average_duration.eye_neface_h]=signrank(Gaze_summary.(region_id).(monkey_id).m1_eye.average_duration,Gaze_summary.(region_id).(monkey_id).m1_neface.average_duration);
        [Stats.(region_id).(monkey_id).average_duration.eye_dot_p,Stats.(region_id).(monkey_id).average_duration.eye_dot_h]=signrank(Gaze_summary.(region_id).(monkey_id).m1_eye.average_duration,Dot_summary.(region_id).(monkey_id).m1_eye.average_duration);
        
    end

    % Ranksum is not paired (median)

    [Stats_region.(monkey_id).total_number.m1_eye.OFC_ACCg_p,Stats_region.(monkey_id).total_number.m1_eye.OFC_ACCg_h]=ranksum(Gaze_summary.OFC.(monkey_id).m1_eye.total_number,Gaze_summary.ACCg.(monkey_id).m1_eye.total_number);
    [Stats_region.(monkey_id).total_number.m1_eye.OFC_dmPFC_p,Stats_region.(monkey_id).total_number.m1_eye.OFC_dmPFC_h]=ranksum(Gaze_summary.OFC.(monkey_id).m1_eye.total_number,Gaze_summary.dmPFC.(monkey_id).m1_eye.total_number);    
    [Stats_region.(monkey_id).total_number.m1_eye.ACCg_dmPFC_p,Stats_region.(monkey_id).total_number.m1_eye.ACCg_dmPFC_h]=ranksum(Gaze_summary.ACCg.(monkey_id).m1_eye.total_number,Gaze_summary.dmPFC.(monkey_id).m1_eye.total_number);    

    [Stats_region.(monkey_id).total_number.m1_neface.OFC_ACCg_p,Stats_region.(monkey_id).total_number.m1_neface.OFC_ACCg_h]=ranksum(Gaze_summary.OFC.(monkey_id).m1_neface.total_number,Gaze_summary.ACCg.(monkey_id).m1_neface.total_number);
    [Stats_region.(monkey_id).total_number.m1_neface.OFC_dmPFC_p,Stats_region.(monkey_id).total_number.m1_neface.OFC_dmPFC_h]=ranksum(Gaze_summary.OFC.(monkey_id).m1_neface.total_number,Gaze_summary.dmPFC.(monkey_id).m1_neface.total_number);    
    [Stats_region.(monkey_id).total_number.m1_neface.ACCg_dmPFC_p,Stats_region.(monkey_id).total_number.m1_neface.ACCg_dmPFC_h]=ranksum(Gaze_summary.ACCg.(monkey_id).m1_neface.total_number,Gaze_summary.dmPFC.(monkey_id).m1_neface.total_number);  

    [Stats_region.(monkey_id).total_number.m1_dot.OFC_ACCg_p,Stats_region.(monkey_id).total_number.m1_dot.OFC_ACCg_h]=ranksum(Dot_summary.OFC.(monkey_id).m1_eye.total_number,Dot_summary.ACCg.(monkey_id).m1_eye.total_number);
    [Stats_region.(monkey_id).total_number.m1_dot.OFC_dmPFC_p,Stats_region.(monkey_id).total_number.m1_dot.OFC_dmPFC_h]=ranksum(Dot_summary.OFC.(monkey_id).m1_eye.total_number,Dot_summary.dmPFC.(monkey_id).m1_eye.total_number);    
    [Stats_region.(monkey_id).total_number.m1_dot.ACCg_dmPFC_p,Stats_region.(monkey_id).total_number.m1_dot.ACCg_dmPFC_h]=ranksum(Dot_summary.ACCg.(monkey_id).m1_eye.total_number,Dot_summary.dmPFC.(monkey_id).m1_eye.total_number);  

    [Stats_region.(monkey_id).average_duration.m1_eye.OFC_ACCg_p,Stats_region.(monkey_id).average_duration.m1_eye.OFC_ACCg_h]=ranksum(Gaze_summary.OFC.(monkey_id).m1_eye.average_duration,Gaze_summary.ACCg.(monkey_id).m1_eye.average_duration);
    [Stats_region.(monkey_id).average_duration.m1_eye.OFC_dmPFC_p,Stats_region.(monkey_id).average_duration.m1_eye.OFC_dmPFC_h]=ranksum(Gaze_summary.OFC.(monkey_id).m1_eye.average_duration,Gaze_summary.dmPFC.(monkey_id).m1_eye.average_duration);    
    [Stats_region.(monkey_id).average_duration.m1_eye.ACCg_dmPFC_p,Stats_region.(monkey_id).average_duration.m1_eye.ACCg_dmPFC_h]=ranksum(Gaze_summary.ACCg.(monkey_id).m1_eye.average_duration,Gaze_summary.dmPFC.(monkey_id).m1_eye.average_duration);    

    [Stats_region.(monkey_id).average_duration.m1_neface.OFC_ACCg_p,Stats_region.(monkey_id).average_duration.m1_neface.OFC_ACCg_h]=ranksum(Gaze_summary.OFC.(monkey_id).m1_neface.average_duration,Gaze_summary.ACCg.(monkey_id).m1_neface.average_duration);
    [Stats_region.(monkey_id).average_duration.m1_neface.OFC_dmPFC_p,Stats_region.(monkey_id).average_duration.m1_neface.OFC_dmPFC_h]=ranksum(Gaze_summary.OFC.(monkey_id).m1_neface.average_duration,Gaze_summary.dmPFC.(monkey_id).m1_neface.average_duration);    
    [Stats_region.(monkey_id).average_duration.m1_neface.ACCg_dmPFC_p,Stats_region.(monkey_id).average_duration.m1_neface.ACCg_dmPFC_h]=ranksum(Gaze_summary.ACCg.(monkey_id).m1_neface.average_duration,Gaze_summary.dmPFC.(monkey_id).m1_neface.average_duration);  
  
    [Stats_region.(monkey_id).average_duration.m1_dot.OFC_ACCg_p,Stats_region.(monkey_id).average_duration.m1_dot.OFC_ACCg_h]=ranksum(Dot_summary.OFC.(monkey_id).m1_eye.average_duration,Dot_summary.ACCg.(monkey_id).m1_eye.average_duration);
    [Stats_region.(monkey_id).average_duration.m1_dot.OFC_dmPFC_p,Stats_region.(monkey_id).average_duration.m1_dot.OFC_dmPFC_h]=ranksum(Dot_summary.OFC.(monkey_id).m1_eye.average_duration,Dot_summary.dmPFC.(monkey_id).m1_eye.average_duration);    
    [Stats_region.(monkey_id).average_duration.m1_dot.ACCg_dmPFC_p,Stats_region.(monkey_id).average_duration.m1_dot.ACCg_dmPFC_h]=ranksum(Dot_summary.ACCg.(monkey_id).m1_eye.average_duration,Dot_summary.dmPFC.(monkey_id).m1_eye.average_duration);  

end

save('Gaze_Dot_Comparison_ROI_Stats_Combined.mat','Stats','-v7.3')
save('Gaze_Dot_Comparison_ROI_Stats_Region_Combined.mat','Stats_region','-v7.3')

%% fdr correction

% All days (no need to correct, only one comparison)

total_number_p_raw=[Stats.All_day.(monkey_id).total_number.eye_neface_p Stats.(region_id).(monkey_id).total_number.eye_dot_p];
total_number_p_correct=dsp3.fdr([Stats.All_day.(monkey_id).total_number.eye_neface_p Stats.(region_id).(monkey_id).total_number.eye_dot_p]);

average_duration_p_raw=[Stats.(region_id).(monkey_id).average_duration.eye_neface_p Stats.(region_id).(monkey_id).average_duration.eye_dot_p];
average_duration_p_correct=dsp3.fdr([Stats.(region_id).(monkey_id).average_duration.eye_neface_p Stats.(region_id).(monkey_id).average_duration.eye_dot_p]);

% By region 1-2: eyes vs. neface and eyes vs. dot for OFC
% By region 3-4: eyes vs. neface and eyes vs. dot for ACCg
% By region 5-6: eyes vs. neface and eyes vs. dot for dmPFC
% By region 7-9: OFC vs. ACCg, OFC vs. dmPFC, ACCg vs. dmPFC for Eyes
% By region 10-12: OFC vs. ACCg, OFC vs. dmPFC, ACCg vs. dmPFC for Neface
% By region 13-15: OFC vs. ACCg, OFC vs. dmPFC, ACCg vs. dmPFC for Dots

By_region_total_number_p_raw=[Stats.OFC.All.total_number.eye_neface_p   Stats.OFC.All.total_number.eye_dot_p...
   Stats.ACCg.All.total_number.eye_neface_p   Stats.ACCg.All.total_number.eye_dot_p...
   Stats.dmPFC.All.total_number.eye_neface_p   Stats.dmPFC.All.total_number.eye_dot_p...
   Stats_region.All.total_number.m1_eye.OFC_ACCg_p   Stats_region.All.total_number.m1_eye.OFC_dmPFC_p   Stats_region.All.total_number.m1_eye.ACCg_dmPFC_p...
   Stats_region.All.total_number.m1_neface.OFC_ACCg_p   Stats_region.All.total_number.m1_neface.OFC_dmPFC_p   Stats_region.All.total_number.m1_neface.ACCg_dmPFC_p...
   Stats_region.All.total_number.m1_dot.OFC_ACCg_p   Stats_region.All.total_number.m1_dot.OFC_dmPFC_p   Stats_region.All.total_number.m1_dot.ACCg_dmPFC_p];

By_region_total_number_p_correct=dsp3.fdr([Stats.OFC.All.total_number.eye_neface_p   Stats.OFC.All.total_number.eye_dot_p...
   Stats.ACCg.All.total_number.eye_neface_p   Stats.ACCg.All.total_number.eye_dot_p...
   Stats.dmPFC.All.total_number.eye_neface_p   Stats.dmPFC.All.total_number.eye_dot_p...
   Stats_region.All.total_number.m1_eye.OFC_ACCg_p   Stats_region.All.total_number.m1_eye.OFC_dmPFC_p   Stats_region.All.total_number.m1_eye.ACCg_dmPFC_p...
   Stats_region.All.total_number.m1_neface.OFC_ACCg_p   Stats_region.All.total_number.m1_neface.OFC_dmPFC_p   Stats_region.All.total_number.m1_neface.ACCg_dmPFC_p...
   Stats_region.All.total_number.m1_dot.OFC_ACCg_p   Stats_region.All.total_number.m1_dot.OFC_dmPFC_p   Stats_region.All.total_number.m1_dot.ACCg_dmPFC_p]);

By_region_average_duration_p_raw=[Stats.OFC.All.average_duration.eye_neface_p   Stats.OFC.All.average_duration.eye_dot_p...
   Stats.ACCg.All.average_duration.eye_neface_p   Stats.ACCg.All.average_duration.eye_dot_p...
   Stats.dmPFC.All.average_duration.eye_neface_p   Stats.dmPFC.All.average_duration.eye_dot_p...
   Stats_region.All.average_duration.m1_eye.OFC_ACCg_p   Stats_region.All.average_duration.m1_eye.OFC_dmPFC_p   Stats_region.All.average_duration.m1_eye.ACCg_dmPFC_p...
   Stats_region.All.average_duration.m1_neface.OFC_ACCg_p   Stats_region.All.average_duration.m1_neface.OFC_dmPFC_p   Stats_region.All.average_duration.m1_neface.ACCg_dmPFC_p...
   Stats_region.All.average_duration.m1_dot.OFC_ACCg_p   Stats_region.All.average_duration.m1_dot.OFC_dmPFC_p   Stats_region.All.average_duration.m1_dot.ACCg_dmPFC_p];

By_region_average_duration_p_correct=dsp3.fdr([Stats.OFC.All.average_duration.eye_neface_p   Stats.OFC.All.average_duration.eye_dot_p...
   Stats.ACCg.All.average_duration.eye_neface_p   Stats.ACCg.All.average_duration.eye_dot_p...
   Stats.dmPFC.All.average_duration.eye_neface_p   Stats.dmPFC.All.average_duration.eye_dot_p...
   Stats_region.All.average_duration.m1_eye.OFC_ACCg_p   Stats_region.All.average_duration.m1_eye.OFC_dmPFC_p   Stats_region.All.average_duration.m1_eye.ACCg_dmPFC_p...
   Stats_region.All.average_duration.m1_neface.OFC_ACCg_p   Stats_region.All.average_duration.m1_neface.OFC_dmPFC_p   Stats_region.All.average_duration.m1_neface.ACCg_dmPFC_p...
   Stats_region.All.average_duration.m1_dot.OFC_ACCg_p   Stats_region.All.average_duration.m1_dot.OFC_dmPFC_p   Stats_region.All.average_duration.m1_dot.ACCg_dmPFC_p]);





